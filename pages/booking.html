<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Transfer | Shuttle Plus</title>
    <meta name="description" content="Book your airport transfer in Addis Ababa. Flight tracking, fixed prices, and instant confirmation.">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#597B87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Shuttle Plus">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/images/icons/icon-152x152.png">

    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/style.css?v=11">
    <link rel="stylesheet" href="../css/booking.css?v=11">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar scrolled" id="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <span class="logo-text"><span class="logo-accent">>></span>Shuttle<span class="logo-accent">Plus</span></span>
            </a>
            <div class="nav-buttons">
                <a href="tickets.html" class="btn btn-outline">
                    <i class="fas fa-ticket-alt"></i> My Tickets
                </a>
            </div>
        </div>
    </nav>

    <!-- Booking Container -->
    <main class="booking-container">
        <!-- Progress Steps (3 steps - simplified) -->
        <div class="booking-progress">
            <div class="progress-step active" data-step="1">
                <span class="step-number">1</span>
                <span class="step-label">Vehicle</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
                <span class="step-number">2</span>
                <span class="step-label">Details</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
                <span class="step-number">3</span>
                <span class="step-label">Confirm</span>
            </div>
        </div>

        <!-- Booking Form -->
        <form id="bookingForm" class="booking-form">
            <!-- Step 1: Vehicle Selection (was Step 2) -->
            <div class="booking-step active" data-step="1">
                <div class="step-header">
                    <h2>Choose Your Ride</h2>
                    <p>Fixed prices, no hidden fees</p>
                </div>

                <!-- Route Summary Card with Edit Button -->
                <div class="route-summary-card" id="routeSummaryCard">
                    <div class="route-card-main">
                        <div class="route-direction">
                            <i class="fas fa-plane-arrival" id="routeIcon"></i>
                            <span id="routeText">Bole Airport → Your Destination</span>
                        </div>
                        <button type="button" class="btn-edit-route" onclick="editRoute()">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                    </div>
                    <div class="route-card-details">
                        <span class="route-detail">
                            <i class="fas fa-calendar"></i>
                            <span id="routeDate">Select date</span>
                        </span>
                        <span class="route-detail">
                            <i class="fas fa-clock"></i>
                            <span id="routeTime">Select time</span>
                        </span>
                        <span class="route-detail">
                            <i class="fas fa-users"></i>
                            <span id="routePassengers">2 passengers</span>
                        </span>
                        <span class="route-detail">
                            <i class="fas fa-suitcase"></i>
                            <span id="routeLuggage">2 bags</span>
                        </span>
                    </div>
                </div>

                <!-- Hidden fields to store route data -->
                <input type="hidden" id="flightNumber" name="flightNumber">
                <input type="hidden" id="destination" name="destination">
                <input type="hidden" id="customAddress" name="customAddress">
                <input type="hidden" id="flightDate" name="flightDate">
                <input type="hidden" id="flightTimeInput" name="flightTime">
                <input type="hidden" id="passengers" name="passengers">
                <input type="hidden" id="luggage" name="luggage">
                <input type="hidden" id="transferType" name="transferType" value="arrival">

                <div class="vehicle-options enhanced">
                    <label class="vehicle-option recommended">
                        <input type="radio" name="vehicleClass" value="standard" checked>
                        <div class="vehicle-card">
                            <span class="popular-badge">Most Popular</span>
                            <div class="vehicle-image">
                                <i class="fas fa-car"></i>
                            </div>
                            <div class="vehicle-info">
                                <h3>Standard Sedan</h3>
                                <p>Toyota Corolla or similar</p>
                                <div class="vehicle-features">
                                    <span><i class="fas fa-user"></i> Up to 3</span>
                                    <span><i class="fas fa-suitcase"></i> 3 bags</span>
                                    <span><i class="fas fa-snowflake"></i> AC</span>
                                </div>
                            </div>
                            <div class="vehicle-price">
                                <span class="price-amount" id="price-standard">$30</span>
                                <span class="price-label">fixed price</span>
                            </div>
                        </div>
                    </label>

                    <label class="vehicle-option">
                        <input type="radio" name="vehicleClass" value="executive">
                        <div class="vehicle-card">
                            <div class="vehicle-image">
                                <i class="fas fa-car-side"></i>
                            </div>
                            <div class="vehicle-info">
                                <h3>Executive Sedan</h3>
                                <p>Toyota Camry, Mercedes E-Class</p>
                                <div class="vehicle-features">
                                    <span><i class="fas fa-user"></i> Up to 3</span>
                                    <span><i class="fas fa-suitcase"></i> 3 bags</span>
                                    <span><i class="fas fa-wifi"></i> WiFi</span>
                                </div>
                            </div>
                            <div class="vehicle-price">
                                <span class="price-amount" id="price-executive">$45</span>
                                <span class="price-label">fixed price</span>
                            </div>
                        </div>
                    </label>

                    <label class="vehicle-option">
                        <input type="radio" name="vehicleClass" value="suv">
                        <div class="vehicle-card">
                            <div class="vehicle-image">
                                <i class="fas fa-car-alt"></i>
                            </div>
                            <div class="vehicle-info">
                                <h3>SUV</h3>
                                <p>Toyota Fortuner, Land Cruiser Prado</p>
                                <div class="vehicle-features">
                                    <span><i class="fas fa-user"></i> Up to 5</span>
                                    <span><i class="fas fa-suitcase"></i> 5 bags</span>
                                    <span><i class="fas fa-snowflake"></i> AC</span>
                                </div>
                            </div>
                            <div class="vehicle-price">
                                <span class="price-amount" id="price-suv">$55</span>
                                <span class="price-label">fixed price</span>
                            </div>
                        </div>
                    </label>

                    <label class="vehicle-option">
                        <input type="radio" name="vehicleClass" value="van">
                        <div class="vehicle-card">
                            <div class="vehicle-image">
                                <i class="fas fa-shuttle-van"></i>
                            </div>
                            <div class="vehicle-info">
                                <h3>Van</h3>
                                <p>Toyota Hiace, Minibus</p>
                                <div class="vehicle-features">
                                    <span><i class="fas fa-user"></i> Up to 11</span>
                                    <span><i class="fas fa-suitcase"></i> 11 bags</span>
                                    <span><i class="fas fa-snowflake"></i> AC</span>
                                </div>
                            </div>
                            <div class="vehicle-price">
                                <span class="price-amount" id="price-van">$63</span>
                                <span class="price-label">fixed price</span>
                            </div>
                        </div>
                    </label>

                    <label class="vehicle-option">
                        <input type="radio" name="vehicleClass" value="luxury">
                        <div class="vehicle-card premium">
                            <span class="premium-badge">Premium</span>
                            <div class="vehicle-image">
                                <i class="fas fa-gem"></i>
                            </div>
                            <div class="vehicle-info">
                                <h3>Luxury Class</h3>
                                <p>Mercedes S-Class, BMW 7-Series</p>
                                <div class="vehicle-features">
                                    <span><i class="fas fa-user"></i> Up to 3</span>
                                    <span><i class="fas fa-suitcase"></i> 3 bags</span>
                                    <span><i class="fas fa-star"></i> VIP</span>
                                </div>
                            </div>
                            <div class="vehicle-price">
                                <span class="price-amount" id="price-luxury">$87</span>
                                <span class="price-label">fixed price</span>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="extras-section">
                    <h4>Extras</h4>
                    <label class="checkbox-option">
                        <input type="checkbox" name="childSeat" id="childSeat">
                        <span class="checkbox-label">
                            <i class="fas fa-baby"></i> Child Seat (+$5)
                        </span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" name="meetGreet" id="meetGreet">
                        <span class="checkbox-label">
                            <i class="fas fa-sign"></i> Meet & Greet with Name Sign (+$5)
                        </span>
                    </label>
                </div>

                <div class="price-guarantee">
                    <i class="fas fa-shield-alt"></i>
                    <span>Price guarantee: No surge pricing, ever. What you see is what you pay.</span>
                </div>

                <div class="step-actions">
                    <button type="button" class="btn btn-primary btn-next btn-large" data-next="2">
                        Continue <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 2: Contact Details (was Step 3) -->
            <div class="booking-step" data-step="2">
                <div class="step-header">
                    <h2>Contact Details</h2>
                    <p>Almost there! Just a few more details</p>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="contactName">
                            <i class="fas fa-user"></i> Full Name
                        </label>
                        <input type="text" id="contactName" name="contactName"
                               placeholder="As shown on ID" required>
                    </div>

                    <div class="form-group">
                        <label for="contactPhone">
                            <i class="fas fa-phone"></i> Phone Number
                        </label>
                        <div class="phone-input-wrapper">
                            <span class="country-code">+251</span>
                            <input type="tel" id="contactPhone" name="contactPhone"
                                   placeholder="9XX XXX XXX" maxlength="9" required>
                        </div>
                        <span class="form-hint">We'll send your confirmation via SMS</span>
                    </div>

                    <div class="form-group full-width">
                        <label for="contactEmail">
                            <i class="fas fa-envelope"></i> Email (Optional)
                        </label>
                        <input type="email" id="contactEmail" name="contactEmail"
                               placeholder="your@email.com">
                    </div>

                    <div class="form-group full-width">
                        <label for="specialRequests">
                            <i class="fas fa-comment"></i> Special Requests (Optional)
                        </label>
                        <textarea id="specialRequests" name="specialRequests" rows="2"
                                  placeholder="Any special requirements or notes for the driver..."></textarea>
                    </div>
                </div>

                <div class="step-actions">
                    <button type="button" class="btn btn-outline btn-prev" data-prev="1">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button type="button" class="btn btn-primary btn-next" data-next="3">
                        Review & Confirm <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Step 3: Review & Confirm (was Step 4) -->
            <div class="booking-step" data-step="3">
                <div class="step-header">
                    <h2>Review & Pay</h2>
                    <p>Please confirm your booking details</p>
                </div>

                <div class="booking-summary">
                    <div class="summary-section">
                        <h4><i class="fas fa-plane"></i> Transfer Details</h4>
                        <div class="summary-row">
                            <span>Type</span>
                            <span id="summaryType">Airport Pickup</span>
                        </div>
                        <div class="summary-row">
                            <span>Flight</span>
                            <span id="summaryFlight">ET 500</span>
                        </div>
                        <div class="summary-row">
                            <span>Date & Time</span>
                            <span id="summaryDateTime">Dec 15, 2025 at 14:30</span>
                        </div>
                        <div class="summary-row">
                            <span>Route</span>
                            <span id="summaryRoute">Airport → Sheraton Addis</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4><i class="fas fa-car"></i> Vehicle</h4>
                        <div class="summary-row">
                            <span>Class</span>
                            <span id="summaryVehicle">Standard Sedan</span>
                        </div>
                        <div class="summary-row">
                            <span>Passengers</span>
                            <span id="summaryPassengers">1-2 Passengers</span>
                        </div>
                    </div>

                    <div class="summary-section">
                        <h4><i class="fas fa-user"></i> Contact</h4>
                        <div class="summary-row">
                            <span>Name</span>
                            <span id="summaryName">-</span>
                        </div>
                        <div class="summary-row">
                            <span>Phone</span>
                            <span id="summaryPhone">-</span>
                        </div>
                        <div class="summary-row" id="summarySpecialRequestsRow" style="display: none;">
                            <span>Special Requests</span>
                            <span id="summarySpecialRequests">-</span>
                        </div>
                    </div>

                    <div class="summary-section pricing">
                        <h4><i class="fas fa-receipt"></i> Price</h4>
                        <div class="summary-row">
                            <span>Base Fare</span>
                            <span id="summaryBaseFare">$30</span>
                        </div>
                        <div class="summary-row" id="summaryChildSeatRow" style="display: none;">
                            <span>Child Seat</span>
                            <span>+$5</span>
                        </div>
                        <div class="summary-row" id="summaryMeetGreetRow" style="display: none;">
                            <span>Meet & Greet</span>
                            <span>+$5</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total</span>
                            <span id="summaryTotal">$30 <small>(1,560 ETB)</small></span>
                        </div>
                    </div>
                </div>

                <div class="payment-section">
                    <h4>Payment Method</h4>
                    <div class="payment-options">
                        <label class="payment-option">
                            <input type="radio" name="paymentMethod" value="cash" checked>
                            <div class="payment-card">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Pay in Cash</span>
                            </div>
                        </label>

                        <label class="payment-option">
                            <input type="radio" name="paymentMethod" value="telebirr">
                            <div class="payment-card">
                                <i class="fas fa-mobile-alt"></i>
                                <span>Telebirr</span>
                            </div>
                        </label>

                        <label class="payment-option">
                            <input type="radio" name="paymentMethod" value="stripe">
                            <div class="payment-card">
                                <i class="fas fa-credit-card"></i>
                                <span>Card</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="terms-section">
                    <label class="checkbox-option">
                        <input type="checkbox" name="termsAccepted" id="termsAccepted" required>
                        <span class="checkbox-label">
                            I agree to the <a href="#" target="_blank">Terms of Service</a> and
                            <a href="#" target="_blank">Cancellation Policy</a>
                        </span>
                    </label>
                </div>

                <div class="step-actions">
                    <button type="button" class="btn btn-outline btn-prev" data-prev="2">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button type="submit" class="btn btn-primary btn-submit">
                        <i class="fas fa-check"></i> Confirm Booking
                    </button>
                </div>
            </div>
        </form>

        <!-- Success State -->
        <div class="booking-success" id="bookingSuccess" style="display: none;">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>Booking Confirmed!</h2>
            <p class="booking-reference">Reference: <strong id="bookingRef">SP-2025-XXXXXX</strong></p>
            <p>A confirmation SMS has been sent to your phone.</p>

            <div class="success-details">
                <div class="detail-item">
                    <i class="fas fa-calendar"></i>
                    <span id="successDate">Dec 15, 2025</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-clock"></i>
                    <span id="successTime">14:30</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-car"></i>
                    <span id="successVehicle">Standard Sedan</span>
                </div>
            </div>

            <div class="success-actions">
                <a href="tickets.html" class="btn btn-primary">
                    <i class="fas fa-ticket-alt"></i> View Ticket
                </a>
                <a href="../index.html" class="btn btn-outline">
                    Back to Home
                </a>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Processing your booking...</p>
    </div>

    <!-- Scripts -->
    <script src="../js/main.js?v=11"></script>
    <script src="../js/app.js?v=11"></script>
    <script src="../js/offline-storage.js?v=11"></script>
    <script src="../js/api-client.js?v=11"></script>
    <script src="../js/booking.js?v=13"></script>
</body>
</html>
